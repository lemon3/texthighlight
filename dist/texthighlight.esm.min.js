/*! For license information please see texthighlight.esm.min.js.LICENSE.txt */
var t={};function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function i(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,n(s.key),s)}}function n(t){var i=function(t,i){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var s=n.call(t,"string");if("object"!=e(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(i)?i:String(i)}var s=function(){function t(e,i){var s,r,a;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),s=this,a=/script|textarea|input/,(r=n(r="notAllowedNodes"))in s?Object.defineProperty(s,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):s[r]=a,e||(e=document.body),null===(e="string"==typeof e?document.querySelector(e):e)||0===e.length)return{error:!0};this.options=i||{},this.settings=Object.assign({},t.defaults,i),this.element=e,this._found=0,this.rand=1e6*Math.random()<<0,this.settings.autoinit&&this.init()}var e,s;return e=t,s=[{key:"_hasWord",value:function(t,e){var i=t.textContent;return!!t.textContent.trim()&&!!i.match(e)}},{key:"_isNodesAllowed",value:function(t){return!t.nodeName.toLowerCase().match(this.notAllowedNodes)}},{key:"_markText",value:function(t,e){if(t.data){for(var i=t.parentNode,n="",s=t.data,r=0;s&&null!==(n=e.exec(s));){var a=document.createElement("span");if(a.className=this.settings.className,a.appendChild(document.createTextNode(n[0])),t.replaceData(n.index,n[0].length,""),r++,s=(t=t.splitText(n.index)).data,a.dataset["marked-"+this.rand]=!0,!s){i.appendChild(a);break}i.insertBefore(a,t)}return r}}},{key:"_replaceText",value:function(t,e,i){if(t.data){var n=t.data,s=0,r=n.match(e);if(r)return s+=r.length,n=n.replaceAll(e,i),t.data&&3===t.nodeType&&(t.data=n),s}}},{key:"_find",value:function(t,e){if(!(!t||t.dataset["marked-"+this.rand]||this.settings.max&&this._found>=this.settings.max))for(t=t.firstChild;null!==t&&this._isNodesAllowed(t);){if(3===t.nodeType){if(this._hasWord(t,e)){var i=this.fun(t,e);this._found+=i;var n=t.parentElement;this.settings.highlightSection&&!n.classList.contains(this.settings.sectionClassName)&&n.classList.add(this.settings.sectionClassName)}}else this._find(t,e);t=t.nextSibling}}},{key:"_createRegexFromInput",value:function(t){var e=!1;if(Array.isArray(t))t=t.join("|");else{var i=(t=t.toString()).indexOf("/"),n=t.lastIndexOf("/");if(i>=0&&n>i){e=!0;var s=t.substr(n+1);t=t.substr(i+1,n-1),s.indexOf("i")>=0?this.settings.caseSensitive=!1:this.settings.caseSensitive=!0}else t=t.replace(/([()[{*+.$^\\|?])/g,"\\$1"),this.settings.fullwordonly&&(t="\\b"+t+"\\b",this.settings.markwholeWord=!1),this.settings.markwholeWord&&(t="\\w*"+t+"\\w*");var r=t.length;if(r<this.settings.minInput||this.settings.maxInput&&r>this.settings.maxInput||e&&t.length<=2&&t.indexOf(".")>=0)return!1}var a=this.settings.caseSensitive?"g":"gi";return new RegExp(t,a)}},{key:"_start",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t&&null!==e){var i=this._createRegexFromInput(e);i?this._find(t,i):this.reset()}}},{key:"highlight",value:function(t){this.reset(),t&&t!==this.input&&(this.input=t,this.fun=this._markText,this._start(this.element,t))}},{key:"delete",value:function(t){this.replace(t,"")}},{key:"replace",value:function(t,e){var i=this;t&&e&&t!==this.input&&(this.input=t,this.fun=function(t,n){return i._replaceText(t,n,e)},this._start(this.element,t,e))}},{key:"reset",value:function(){var t=this;this.element.querySelectorAll("[data-marked-"+this.rand+"]").forEach((function(t){var e,i=t.parentElement;e=t.childNodes.length>1?t.innerText:t.childNodes[0].data,i.replaceChild(document.createTextNode(e),t),i.normalize()})),this.settings.highlightSection&&this.element.querySelectorAll("."+this.settings.sectionClassName).forEach((function(e){e.classList.remove(t.settings.sectionClassName)})),this._found=0}},{key:"getCount",value:function(){return this._found}},{key:"init",value:function(){if(this.initialized)return!0;var t=this.settings.word;t&&this._start(this.element,t)}}],s&&i(e.prototype,s),Object.defineProperty(e,"prototype",{writable:!1}),t}();s.defaults={autoinit:!0,word:null,replace:null,max:null,minInput:2,maxInput:null,caseSensitive:!1,fullwordonly:!1,markwholeWord:!1,className:"highlight",highlightSection:!1,sectionClassName:"section-highlight"},t.A=s;var r=t.A;export{r as default};