/*! For license information please see texthighlight.esm.min.js.LICENSE.txt */
var t={};function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function i(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,n(s.key),s)}}function n(t){var i=function(t,i){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var s=n.call(t,"string");if("object"!=e(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(i)?i:String(i)}var s=function(){function t(i,s){var r,a,o;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=/script|textarea|input|pre|code/,(a=n(a="notAllowedNodes"))in r?Object.defineProperty(r,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[a]=o,i?"string"==typeof i&&(i=document.querySelector(i)):i=document.body,null===i||s&&"object"!==e(s))return{error:!0};this.options=s||{},this.settings=Object.assign({},t.defaults,s),this.element=i,this._found=0,this._rand=1e6*Math.random()<<0,this.fun=this._markText,this.settings.autoinit&&this.init()}var s,r;return s=t,r=[{key:"_hasWord",value:function(t,e){return!!(t&&t.textContent&&t.textContent.trim()&&null!==e&&""!==e)&&!!t.textContent.match(e)}},{key:"_isNodesAllowed",value:function(t){return!t.nodeName.toLowerCase().match(this.notAllowedNodes)}},{key:"_markText",value:function(t,e){if(!t||void 0===t.data)return 0;for(var i=t.data,n=t.parentNode,s="",r=0;i&&null!==(s=e.exec(i));){if(this.settings.max&&r>=this.settings.max)return r;var a=document.createElement("span");a.className=this.settings.className,a.appendChild(document.createTextNode(s[0])),t.replaceData(s.index,s[0].length,""),r++,i=(t=t.splitText(s.index)).data,a.dataset["marked-"+this._rand]=!0,n.insertBefore(a,t)}return r}},{key:"_replaceText",value:function(t,e,i){if(!t||void 0===t.data)return 0;var n=t.data,s=0,r=n.match(e);return r?(s+=r.length,void 0===i&&(i=""),n=n.replaceAll(e,i),t.data=n,s):0}},{key:"_find",value:function(t,e){if(!t||t.dataset["marked-"+this._rand])return!1;for(t=t.firstChild;null!==t&&(!this.settings.max||this._found<this.settings.max);){if(this._isNodesAllowed(t))if(3===t.nodeType){if(this._hasWord(t,e)){var i=this.fun(t,e);this._found+=i;var n=t.parentElement;console.log(n,n.id),this.settings.highlightSection&&!n.classList.contains(this.settings.sectionClassName)&&n.classList.add(this.settings.sectionClassName)}}else this._find(t,e);t=t.nextSibling}return this._found}},{key:"_createRegexFromInput",value:function(t){var e=!1,i=(t=t.toString()).indexOf("/"),n=t.lastIndexOf("/");if(i>=0&&n>i){e=!0;var s=t.substr(n+1);t=t.substr(i+1,n-1),s.indexOf("i")>=0?this.settings.caseSensitive=!1:this.settings.caseSensitive=!0}else t=t.replace(/([()[{*+.$^\\|?])/g,"\\$1"),this.settings.fullwordonly&&(t="\\b"+t+"\\b",this.settings.markwholeWord=!1),this.settings.markwholeWord&&(t="\\w*"+t+"\\w*");var r=t.length;if(r<this.settings.minInput||this.settings.maxInput&&r>this.settings.maxInput||e&&t.length<=2&&t.indexOf(".")>=0)return!1;var a=this.settings.caseSensitive?"g":"gi";return new RegExp(t,a)}},{key:"_start",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t||null===e)return!1;var i=this._createRegexFromInput(e);i?this._find(t,i):this.reset()}},{key:"highlight",value:function(t){return this.reset(),!(!t||t===this._lastInput)&&(this._lastInput=t,this.fun=this._markText,this._start(this.element,t),this)}},{key:"delete",value:function(t){return this.replace(t,"")}},{key:"replace",value:function(t,e){var i=this;return!(!t||"string"!=typeof e||t===this._lastInput)&&(this._lastInput=t,this.fun=function(t,n){return i._replaceText(t,n,e)},this._start(this.element,t,e),this)}},{key:"reset",value:function(){var t=this;this.element.querySelectorAll("[data-marked-"+this._rand+"]").forEach((function(t){var e,i=t.parentElement;e=t.childNodes[0].data,i.replaceChild(document.createTextNode(e),t),i.normalize()})),this.settings.highlightSection&&(this.element.classList.contains(this.settings.sectionClassName)&&this.element.classList.remove(this.settings.sectionClassName),this.element.querySelectorAll("."+this.settings.sectionClassName).forEach((function(e){e.classList.remove(t.settings.sectionClassName)}))),this._lastInput=null,this._found=0}},{key:"getCount",value:function(){return this._found}},{key:"init",value:function(){if(this.initialized)return this;this.initialized=!0;var t=this.settings.search;t&&this._start(this.element,t)}}],r&&i(s.prototype,r),Object.defineProperty(s,"prototype",{writable:!1}),t}();s.defaults={autoinit:!0,search:null,replace:null,max:null,minInput:2,maxInput:null,caseSensitive:!1,fullwordonly:!1,markwholeWord:!1,className:"highlight",highlightSection:!1,sectionClassName:"section-highlight"},t.A=s;var r=t.A;export{r as default};